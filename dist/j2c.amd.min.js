define(function(){"use strict";function e(e,n){for(var r in n)m.call(n,r)&&(!r.indexOf("$")||r in e||(e[r]=n[r]));return e}function n(e,n){var r,t,l=[];for(t in n)if(m.call(n,t))for(r in e)m.call(e,r)&&l.push(e[r]+n[t]);return l}function r(e){for(var n,r=[],t=[],l=0;n=A.exec(e);)switch(n[0]){case"(":l++;break;case")":l--;break;case",":if(l)break;r.push(n.index)}for(n=r.length;n--;)t.unshift(e.slice(r[n]+1)),e=e.slice(0,r[n]);return t.unshift(e),t}function t(e,r){for(var t,l,a=[],i=[];l=Z.exec(e);)"&"==l[0]&&a.push(l.index);for(l=a.length;l--;)i.unshift(e.slice(a[l]+1)),e=e.slice(0,a[l]);for(i.unshift(e),1===i.length&&i.unshift(""),t=[i[0]],l=1;l<i.length;l++)t=n(t,n(r,[i[l]]));return t.join(",")}function l(e){return function n(r){if(d.call(r)===_)for(var t=0;t<r.length;t++)n(r[t]);else e(r)}}function a(e){for(;x.length<e;)x+=Math.floor(4294967296*Math.random()).toString(36);var n="_"+x.slice(0,e);return x=x.slice(e),n}function i(e){return"-"+e.toLowerCase()}function u(e,n,r,t,l){var a,c,o;if(null!=t)switch(d.call(t=t.valueOf())){case _:for(a=0;a<t.length;a++)u(e,n,r,t[a],l);break;case z:for(a in t)if(m.call(t,a))if(c=t[a],/\$/.test(a))for(o in a=a.split("$"))m.call(a,o)&&u(e,n,r+a[o],c,l);else u(e,n,r+a,c,l);break;default:if(!r)return n.raw(t);a=r.replace(/[A-Z]/g,i),!l||"animation-name"!=a&&"animation"!=a||(t=t.split(",").map(function(n){return n.replace(/^\s*(?:(var\([^)]+\))|:?global\(\s*([_A-Za-z][-\w]*)\s*\)|()(-?[_A-Za-z][-\w]*))/,e.localizeReplacer)}).join(",")),n.decl(a,t)}}function c(e,n,r,t,a,i,c){for(var s=0;s<e.atruleHandlers.length;s++)if(e.atruleHandlers[s](e,n,r,t,a,i,c))return;if(!r[3]&&/^global$/.test(r[2]))o(e,n,a,t,0,c);else if(!r[3]&&/^local$/.test(r[2]))o(e,n,a,t,1,c);else if(r[3]&&/^adopt$/.test(r[2])){if(!i||c)return n.err("@adopt global or nested: "+r[0]);if(!/^\.?[_A-Za-z][-\w]*$/.test(r[3]))return n.err("bad adopter "+JSON.stringify(r[3])+" in "+r[0]);s=[],l(function(e,t){null!=e&&/^\.?[_A-Za-z][-\w]*(?:\s+\.?[_A-Za-z][-\w]*)*$/.test(t=e+"")?s.push(t.replace(/\./g,"")):n.err("bad adoptee "+JSON.stringify(e)+" in "+r[0])})(t),s.length&&(e.localize(r[3]=r[3].replace(/\./g,"")),e.names[r[3]]+=" "+s.join(" "))}else!r[3]&&/^(?:namespace|import|charset)$/.test(r[2])?l(function(e){n.atrule(r[1],r[2],e)})(t):!r[3]&&/^(?:font-face|viewport)$/.test(r[2])?l(function(t){n.atrule(r[1],r[2],r[3],"decl"),u(e,n,"",t,i),n._atrule()})(t):r[3]&&/^(?:media|supports|page|keyframes)$/.test(r[2])?(i&&"keyframes"==r[2]&&(r[3]=r[3].replace(/(var\([^)]+\))|:?global\(\s*([_A-Za-z][-\w]*)\s*\)|()(-?[_A-Za-z][-\w]*)/,e.localizeReplacer)),"page"==r[2]?(n.atrule(r[1],r[2],r[3],"decl"),u(e,n,"",t,i)):(n.atrule(r[1],r[2],r[3],"rule"),o(e,n,"keyframes"==r[2]?"":a,t,i,c+1)),n._atrule()):n.err("Unsupported at-rule: "+r[0])}function o(e,n,l,a,i,s){var f,p,h,g;switch(d.call(a)){case z:for(f in a)if(m.call(a,f))if(p=a[f],l.length>0&&/^\*?[-\w$]+$/.test(f))if(h||(h=1,n.rule(l)),/\$/.test(f))for(g in f=f.split("$"))m.call(f,g)&&u(e,n,f[g],p,i);else u(e,n,f,p,i);else if(/^@/.test(f))h=0,c(e,n,/^(.(?:-[\w]+-)?([_A-Za-z][-\w]*))\b\s*([\s\S]*?)\s*$/.exec(f)||[f,"@","",""],p,l,i,s);else{if(h=0,""===f){n._rule(),n.err("Invalid selector ''");continue}o(e,n,l.length>0&&(/,/.test(l)||/,/.test(f))?(g=r(l),r(i?f.replace(/("(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\/)|:global\(\s*(\.-?[_A-Za-z][-\w]*)\s*\)|(\.)(-?[_A-Za-z][-\w]*)/g,e.localizeReplacer):f).map(function(e){return/&/.test(e)?t(e,g):g.map(function(n){return n+e}).join(",")}).join(",")):/&/.test(f)?t(i?f.replace(/("(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\/)|:global\(\s*(\.-?[_A-Za-z][-\w]*)\s*\)|(\.)(-?[_A-Za-z][-\w]*)/g,e.localizeReplacer):f,[l]):l+(i?f.replace(/("(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\/)|:global\(\s*(\.-?[_A-Za-z][-\w]*)\s*\)|(\.)(-?[_A-Za-z][-\w]*)/g,e.localizeReplacer):f),p,i,s+1)}break;case _:for(f=0;f<a.length;f++)o(e,n,l,a[f],i,s);break;case v:l.length&&n.rule(l),n.raw(a)}}function s(e,n){var r;return n?e:{init:function(){r="",e.init()},done:function(){return r&&(e._rule(),r=""),e.done()},atrule:function(n,t,l,a){r&&(e._rule(),r=""),e.atrule(n,t,l,a)},_atrule:function(n){r&&(e._rule(),r=""),e._atrule(n)},rule:function(n){n!==r&&(r&&e._rule(),e.rule(n),r=n)},_rule:function(){r&&(e._rule(),r="")}}}function f(e,n,r,t){t.init();try{e(r,t,"",n,1,0)}catch(e){t.err(e instanceof Error?e.stack:""+e)}return t.done()}function p(n,r,t,l,a,i){function c(e){return m.call(s,e)||(s[e]=n+e+r),s[e].match(/^\S+/)}for(var s={},h={atruleHandlers:t,names:s,localize:c,localizeReplacer:function(e,n,r,t,l){return n||r||t+c(l)}},g={ns:function(e){var n="__"+e.replace(/\W+/g,"_")+"_";return m.call(l,n)||(l[n]=p(n,r,t,l,a,i)),l[n]},names:s,prefix:n,suffix:r,sheet:function(e){return f(o,e,h,a[0])},inline:function(e){return f(u,e,h,a[1])}},d=i.length;d--;)e(g,i[d]);return g}function h(n){n=n||{};var r,t,i=[{init:function(){r=[],t=[]},done:function(e){if(0!=t.length)throw new Error("j2c error(s): "+JSON.stringify(t,null,2)+" in context:\n"+r.join(""));return e?r:r.join("")},err:function(e){t.push(e),r.push("/* +++ ERROR +++ "+e+" */\n")},raw:function(e){r.push(e,"\n")},atrule:function(e,n,t,l){r.push(e,t&&" ",t,l?" {\n":";\n")},_atrule:function(){r.push("}\n")},rule:function(e){r.push(e," {\n")},_rule:function(){r.push("}\n")},decl:function(e,n){r.push(e,":",n,";\n")}}],u=[s],c=[],o=[],f=a(7),h={};d.call(n.plugins)===_&&l(function(e){if(d.call(e)!==z)throw new Error("bad plugin, object expected, got "+d.call(e));d.call(e.filter)===b&&u.push(e.filter),d.call(e.atrule)===b&&c.push(e.atrule),d.call(e.sink)===b&&(i=e.sink()),d.call(e.set)===z&&o.push(e.set)})(n.plugins),d.call(n.suffix)===v&&(f=n.suffix),d.call(n.suffix)===w&&(f=a(n.suffix)),i[1]=i[1]||{init:i[0].init,done:i[0].done,raw:i[0].raw,err:i[0].err,decl:i[0].decl};for(var g=0;g<2;g++)for(var m=u.length;m--;)i[g]=$(e(u[m](i[g],!!g),i[g]));return $(p("",f,c,h,i,o))}var g={},d=g.toString,_=d.call([]),w=d.call(0),z=d.call(g),v=d.call(""),b=d.call(d),m=g.hasOwnProperty,$=Object.freeze||function(e){return e},A=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g,Z=/&|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g,x="";return h});